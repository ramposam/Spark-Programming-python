20/11/04 12:26:07 INFO Read From HDFS and Write to AWS S3: Starting spark session...
20/11/04 12:26:07 INFO Read From HDFS and Write to AWS S3: passing input directory and aws credntials as an arguments 
20/11/04 12:26:28 INFO Read From HDFS and Write to AWS S3: Acutal columns: struct<20-Day Simple Moving Average:double,200-Day Simple Moving Average:double,50-Day High:double,50-Day Low:double,50-Day Simple Moving Average:double,52-Week High:double,52-Week Low:double,Analyst Recom:double,Average True Range:double,Average Volume:double,Beta:double,Change:double,Change from Open:double,Company:string,Country:string,Current Ratio:double,Dividend Yield:double,EPS (ttm):double,EPS growth next 5 years:double,EPS growth next year:double,EPS growth past 5 years:double,EPS growth quarter over quarter:double,EPS growth this year:double,Earnings Date:struct<$date:bigint>,Float Short:double,Forward P/E:double,Gap:double,Gross Margin:double,Industry:string,Insider Ownership:double,Insider Transactions:double,Institutional Ownership:double,Institutional Transactions:double,LT Debt/Equity:double,Market Cap:double,Operating Margin:double,P/B:double,P/Cash:double,P/E:double,P/Free Cash Flow:double,P/S:double,PEG:double,Payout Ratio:double,Performance (Half Year):double,Performance (Month):double,Performance (Quarter):double,Performance (Week):double,Performance (YTD):double,Performance (Year):double,Price:double,Profit Margin:double,Quick Ratio:double,Relative Strength Index (14):double,Relative Volume:double,Return on Assets:double,Return on Equity:double,Return on Investment:double,Sales growth past 5 years:double,Sales growth quarter over quarter:double,Sector:string,Shares Float:double,Shares Outstanding:double,Short Ratio:double,Ticker:string,Total Debt/Equity:double,Volatility (Month):double,Volatility (Week):double,Volume:bigint,_id:struct<$oid:string>>
20/11/04 12:26:28 INFO Read From HDFS and Write to AWS S3: Renamed columns:struct<20_day_simple_moving_average:double,200_day_simple_moving_average:double,50_day_high:double,50_day_low:double,50_day_simple_moving_average:double,52_week_high:double,52_week_low:double,analyst_recom:double,average_true_range:double,average_volume:double,beta:double,change:double,change_from_open:double,company:string,country:string,current_ratio:double,dividend_yield:double,eps__ttm_:double,eps_growth_next_5_years:double,eps_growth_next_year:double,eps_growth_past_5_years:double,eps_growth_quarter_over_quarter:double,eps_growth_this_year:double,earnings_date:struct<$date:bigint>,float_short:double,forward_p_e:double,gap:double,gross_margin:double,industry:string,insider_ownership:double,insider_transactions:double,institutional_ownership:double,institutional_transactions:double,lt_debt_equity:double,market_cap:double,operating_margin:double,p_b:double,p_cash:double,p_e:double,p_free_cash_flow:double,p_s:double,peg:double,payout_ratio:double,performance__half_year_:double,performance__month_:double,performance__quarter_:double,performance__week_:double,performance__ytd_:double,performance__year_:double,price:double,profit_margin:double,quick_ratio:double,relative_strength_index__14_:double,relative_volume:double,return_on_assets:double,return_on_equity:double,return_on_investment:double,sales_growth_past_5_years:double,sales_growth_quarter_over_quarter:double,sector:string,shares_float:double,shares_outstanding:double,short_ratio:double,ticker:string,total_debt_equity:double,volatility__month_:double,volatility__week_:double,volume:bigint,_id:struct<$oid:string>>
20/11/04 12:26:28 INFO Read From HDFS and Write to AWS S3: Schema definition:StructType(List(StructField(20_day_simple_moving_average,DoubleType,true),StructField(200_day_simple_moving_average,DoubleType,true),StructField(50_day_high,DoubleType,true),StructField(50_day_low,DoubleType,true),StructField(50_day_simple_moving_average,DoubleType,true),StructField(52_week_high,DoubleType,true),StructField(52_week_low,DoubleType,true),StructField(analyst_recom,DoubleType,true),StructField(average_true_range,DoubleType,true),StructField(average_volume,DoubleType,true),StructField(beta,DoubleType,true),StructField(change,DoubleType,true),StructField(change_from_open,DoubleType,true),StructField(company,StringType,true),StructField(country,StringType,true),StructField(current_ratio,DoubleType,true),StructField(dividend_yield,DoubleType,true),StructField(eps__ttm_,DoubleType,true),StructField(eps_growth_next_5_years,DoubleType,true),StructField(eps_growth_next_year,DoubleType,true),StructField(eps_growth_past_5_years,DoubleType,true),StructField(eps_growth_quarter_over_quarter,DoubleType,true),StructField(eps_growth_this_year,DoubleType,true),StructField(earnings_date,StructType(List(StructField($date,LongType,true))),true),StructField(float_short,DoubleType,true),StructField(forward_p_e,DoubleType,true),StructField(gap,DoubleType,true),StructField(gross_margin,DoubleType,true),StructField(industry,StringType,true),StructField(insider_ownership,DoubleType,true),StructField(insider_transactions,DoubleType,true),StructField(institutional_ownership,DoubleType,true),StructField(institutional_transactions,DoubleType,true),StructField(lt_debt_equity,DoubleType,true),StructField(market_cap,DoubleType,true),StructField(operating_margin,DoubleType,true),StructField(p_b,DoubleType,true),StructField(p_cash,DoubleType,true),StructField(p_e,DoubleType,true),StructField(p_free_cash_flow,DoubleType,true),StructField(p_s,DoubleType,true),StructField(peg,DoubleType,true),StructField(payout_ratio,DoubleType,true),StructField(performance__half_year_,DoubleType,true),StructField(performance__month_,DoubleType,true),StructField(performance__quarter_,DoubleType,true),StructField(performance__week_,DoubleType,true),StructField(performance__ytd_,DoubleType,true),StructField(performance__year_,DoubleType,true),StructField(price,DoubleType,true),StructField(profit_margin,DoubleType,true),StructField(quick_ratio,DoubleType,true),StructField(relative_strength_index__14_,DoubleType,true),StructField(relative_volume,DoubleType,true),StructField(return_on_assets,DoubleType,true),StructField(return_on_equity,DoubleType,true),StructField(return_on_investment,DoubleType,true),StructField(sales_growth_past_5_years,DoubleType,true),StructField(sales_growth_quarter_over_quarter,DoubleType,true),StructField(sector,StringType,true),StructField(shares_float,DoubleType,true),StructField(shares_outstanding,DoubleType,true),StructField(short_ratio,DoubleType,true),StructField(ticker,StringType,true),StructField(total_debt_equity,DoubleType,true),StructField(volatility__month_,DoubleType,true),StructField(volatility__week_,DoubleType,true),StructField(volume,LongType,true),StructField(_id,StructType(List(StructField($oid,StringType,true))),true)))
20/11/04 12:26:30 INFO Read From HDFS and Write to AWS S3: Write dataframe result to AWS S3
